<!DOCTYPE html>
<html>
<head>
	<title>test</title>
</head>
<body>

<div id="test" style="background-color: red; width: 200px; height: 200px; margin-left: 200px;"></div>
<div id="text"></div>
<div id="rotateX"></div>
<div id="rotateY"></div>
<script type="text/javascript">

class Swipe{
	constructor(elID, minDist){
		this.touchArea = document.getElementById(elID);
		this.orgCoor = null;
		this.surfaceEdge = {
			X: [null, null],
			Y: [null, null]
		};

		this.minDist = (minDist === undefined ? 25 : minDist);

		this.validateEndTouch = this.validateEndTouch.bind(this);
		this.validateDistance = this.validateDistance.bind(this);
		this.detectSwipe = this.detectSwipe.bind(this);
		this.startSwipe = this.startSwipe.bind(this);
		this.endSwipe = this.endSwipe.bind(this);
		this.swipe = this.swipe.bind(this);
	}

	validateEndTouch(X, Y){
		if((X === this.orgCoor[0]) && (Y === this.orgCoor[1])){
			return false;
		}
		if( !(X > this.surfaceEdge.X[0] && X < this.surfaceEdge.X[1]) ){
			return false;
		}
		if( !(Y > this.surfaceEdge.Y[0] && Y < this.surfaceEdge.Y[1]) ){
			return false;
		}
		return true;		
	}

	validateDistance(X, Y){
		const dist = Math.sqrt(
			Math.pow(X - this.orgCoor[0], 2) + Math.pow(Y - this.orgCoor[1], 2)
		);

		return (dist >= this.minDist);
	}

	detectSwipe(X, Y){

		const angle = Math.atan2(Y - this.orgCoor[1], X - this.orgCoor[0]) * 180 / Math.PI;

		if(angle > -135 && angle < -45){
			return 'top';
		}
		else if(angle > -45 && angle <  45){
			return 'right';
		}
		else if(angle > 45 && angle <  135){
			return 'bottom';
		}
		else if(angle > 135 || angle <  -135){
			return 'left';
		}
		else{
			return 'none';
		}

		return angle;
	}

	startSwipe(X, Y){
		const rect = this.touchArea.getBoundingClientRect();
		this.surfaceEdge.X = [
			rect.left, rect.left + rect.width
		];
		this.surfaceEdge.Y = [
			rect.top, rect.top + rect.height
		];

		this.orgCoor = [X, Y];
		console.log(this.surfaceEdge);
	}

	endSwipe(X, Y){
		if(!this.validateEndTouch(X, Y)){
			return 'none';
		}
		if(!this.validateDistance(X, Y)){
			return 'none';
		}		
		return this.detectSwipe(X, Y);
	}

	swipe(callback){
		const startSwipe = this.startSwipe;
		const endSwipe = this.endSwipe;

		this.touchArea.addEventListener('touchstart', function(e){
			e.preventDefault();
			e.stopPropagation();
			startSwipe(
				e.changedTouches[0].clientX,
				e.changedTouches[0].clientY
			);
		});

		this.touchArea.addEventListener('touchend', function(e){
			e.preventDefault();
			e.stopPropagation();
			callback(
				endSwipe(e.changedTouches[0].clientX,e.changedTouches[0].clientY)
			);
		});		
	}
}

const x = new Swipe('test');

x.swipe(function(swipeDir){
	document.getElementById('text').innerHTML = swipeDir;
});

</script>
</body>
</html>